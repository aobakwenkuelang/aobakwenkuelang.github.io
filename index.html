<!doctype html>

<html lang="en">

<head>
     
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    
</head>

<body>
    
    <canvas id="weatherChart"></canvas>
    
    <script>
        
    
        var url = "http://api.openweathermap.org/data/2.5/forecast?lat=24.682&lon=25.9231&appid=a0dcb7940e8fd97debd3488118115822&units=metric";
        
        
        //fecth JSON data from OpenWeatherMap
        
        var weatherJSON = 
        
        fetch(url)
            .then(function(response) {
            return response.json();
        })
            .then(function(JSONresult) {
            
            
            //from this JSON object we need to obtain values for dates, min temp and max temp to use later in our chart
                
                
                //date string values, these are not formatted.
                var d1Fullstring = JSONresult["list"]["2"]["dt_txt"];
                
                var d2Fullstring = JSONresult["list"]["10"]["dt_txt"];
                
                var d3Fullstring = JSONresult["list"]["18"]["dt_txt"];
                
                var d4Fullstring = JSONresult["list"]["26"]["dt_txt"];
                
                var d5Fullstring = JSONresult["list"]["34"]["dt_txt"];
                
                
                
                // date string values formatted to show only day and month
                var day01 = d1Fullstring.substring(5, d1Fullstring.length - 8);
                
                var day02 = d2Fullstring.substring(5, d1Fullstring.length - 8);
                
                var day03 = d3Fullstring.substring(5, d1Fullstring.length - 8);
                
                var day04 = d4Fullstring.substring(5, d1Fullstring.length - 8);
                
                var day05 = d5Fullstring.substring(5, d1Fullstring.length - 8)
                
                
//                console.log(JSONresult["list"]["0"]["main"]["temp_max"]);
                
                 
                // create a new canvas element. my Chart will be drawn on this.
                
                var ctx = document.getElementById('weatherChart').getContext('2d');
                
                
                var chart = new Chart(ctx, {
                    
                    type: 'line',

                    data: {
                        labels: [day01, day02, day03, day04, day05],
                        datasets: [{
                            label: "Max Temperature Gaborone",
                            
                            borderColor: '#ff0000',
                            fill:false,
                            
                            //add temperature data from JSON object
                            data: [JSONresult["list"]["0"]["main"]["temp_max"], JSONresult["list"]["1"]["main"]["temp_max"], JSONresult["list"]["2"]["main"]["temp_max"], JSONresult["list"]["3"]["main"]["temp_max"], JSONresult["list"]["0"]["main"]["temp_max"]],
                            
                        }, {
                            label: "Min Temperature Gaborone",
                            fill:false,
                            borderColor: '#0000ff',
                            
                            data:[JSONresult["list"]["0"]["main"]["temp_min"], JSONresult["list"]["1"]["main"]["temp_min"], JSONresult["list"]["2"]["main"]["temp_min"], JSONresult["list"]["3"]["main"]["temp_min"], JSONresult["list"]["4"]["main"]["temp_min"]]
                        }]
                    },

                    
                });
        });
        
    </script>
    
        
</body>
</html>
